<script>
  // UI imports
  import Field from 'ui/components/Field.svelte';
  import Tab from 'ui/tabs/Tab.svelte';

  // i18n
  import { t } from 'svelte-i18n';
  import {
    ACCOUNT_NUMBER_LABEL,
    ACCOUNT_NUMBER_HELP,
    ACCOUNT_NUMBER_CONFIRM_LABEL,
    ACCOUNT_NUMBER_CONFIRM_HELP,
    IFSC_LABEL,
    IFSC_HELP,
    NAME_LABEL,
    NAME_HELP,
  } from 'ui/labels/payouts';

  // Refs
  export let accountNumberField = null;
  export let confirmAccountNumberField = null;

  export function validateConfirmAccount() {
    const value = accountNumberField.getValue();
    const confirmValue = confirmAccountNumberField.getValue();
    if (value !== confirmValue) {
      confirmAccountNumberField.setValid(false);
    }
  }
</script>

<style>
  .fields-container {
    padding: 16px;
  }
</style>

<Tab method="payout_account" overrideMethodCheck={true} pad={false}>

  <div class="fields-container">

    <Field
      type="text"
      name="account_number"
      id="account_number"
      placeholder={$t(ACCOUNT_NUMBER_LABEL)}
      helpText={$t(ACCOUNT_NUMBER_HELP)}
      maxlength="20"
      required={true}
      bind:this={accountNumberField}
      formatter={{ type: 'number' }}
      on:blur={validateConfirmAccount} />

    <Field
      type="text"
      name="account_number_confirm"
      id="account_number_confirm"
      placeholder={$t(ACCOUNT_NUMBER_CONFIRM_LABEL)}
      helpText={$t(ACCOUNT_NUMBER_CONFIRM_HELP)}
      maxlength="20"
      required={true}
      bind:this={confirmAccountNumberField}
      refresh={false}
      formatter={{ type: 'number' }}
      on:blur={validateConfirmAccount} />

    <Field
      type="text"
      name="ifsc"
      id="ifsc"
      placeholder={$t(IFSC_LABEL)}
      helpText={$t(IFSC_HELP)}
      maxlength="11"
      required={true}
      formatter={{ type: 'ifsc' }} />

    <Field
      type="text"
      name="name"
      id="name"
      placeholder={$t(NAME_LABEL)}
      helpText={$t(NAME_HELP)}
      pattern={"^[a-zA-Z. 0-9']{1,100}$"}
      maxlength="100"
      required={true} />

  </div>

</Tab>
